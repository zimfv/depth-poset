\documentclass{article}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{booktabs}


\begin{document}


\section{Problems}
\par Write $\text{Succ}(s, t) = \text{Succ}'(s, t) = \text{Succ}''(s, t)$ for the succesors and $\text{Pred}(s, t) = \text{Pred}'(s, t) = \text{Pred}''(s, t)$ for the predecessors (ancessors) of the pair in $D$, $D'$, $D''$, respectively.

\par Since $D = D' \cup D''$, we also have $\text{Succ}(s, t) = \text{Succ}'(s, t) \cup \text{Succ}''(s, t)$ and $\text{Pred}(s, t) = \text{Pred}'(s, t) \cup \text{Pred}''(s, t)$.

\subsection{Lemma 3.1.}
\par Suppose $(x, y)$ and $(a, b)$ are birth-death pairs of $f: X\to R$, $a, x$ are consecutive in the ordering of the cellls by $f$, and the transposition $a, x$ is a switch. Then
$$
\text{Succ}'(a, y) = \{(x, b)\} \cup \text{Succ}'(a, b) \cup \{(s, t)\in \text{Succ}'(x, y) | f(t)<f(b)\}
$$
$$
%\text{Succ}'(x, b) = \{(s, t)\in \text{Succ}'(x, y) \oplus \text{Succ}'(a, b) | f(t) > f(b)\}
\text{Succ}'(x, b) = \{(s, t)\in \text{Succ}'(x, y) \cup \text{Succ}'(a, b) | f(t) > f(b)\}
$$

\subsection{Lemma 3.2.}
\par Suppose $(a, b)$ and $(x, y)$ are birth-death pairs of $f:X\to R$, $y, b$ are consecutive in the ordering by $f$, and transposition of $y, b$ is a switch. Then
$$
\text{Succ}''(x, b) = \{(a, y)\} \cup \text{Succ}''(a, b) \cup \{(s, t)\in \text{Succ}''(x, y) | f(a) < f(s)\}
$$
$$
%\text{Succ}''(a, y) = \{(s, t)\in \text{Succ}''(a, b) \oplus \text{Succ}''(x, y) | f(s) < f(a)\}
\text{Succ}''(a, y) = \{(s, t)\in \text{Succ}''(a, b) \cup \text{Succ}''(x, y) | f(s) < f(a)\}
$$

\subsection{Lemma 3.3.}
\par Suppose $(a, b)$ and $(x, y)$ are birth-death pairs of $f$: $X\to R$, $b, x$ are consecutive in the ordering by $f$, and the transposition of $b, x$ is a switch. Then
$$
\text{Succ}(a, x) = \text{Succ}(a, b)
\;\;\text{and}\;\;
\text{Succ}(b, y) = \text{Succ}(x, y)
$$

\subsection{Hypothesis 1}
\par Suppose $a$ and $b$ are 2-simplices consecutive in the ordering by $f$. And there is another Morse function $f^*$:
$$
f^*(s) =
\begin{cases}
f(s), \; \text{if} \; s\ne a, b \\
f(b), \; \text{if} \; s = a \\
f(a), \; \text{if} \; s = b
\end{cases}
$$
Let's denote $DP_{f}^\text{min}$ the transitive reduction of the Depth Poset defined by the filtration $f$. And let's deonote $DP_{f}^\text{min}(s)$ the set of nodes in $DP_f(s)$ which are pairs containing cell $s$ and the set of edges with these nodes.

\par \textbf{Hypothesis:} if the cell $s$ has no faces and cofaces with $a$ and $b$, then $DP_f^\text{min}(s) = DP_{f^*}^\text{min}(s)$.


\section{Model and Experiments}

\par The probabilistic model is simple. The first we just generate the cloud of $n$ points uniformly distributed in $[0, 1]^d$. After this we calculate the Alpha Complex with these points, and then find its Depth Poset. Then we itarate all neighbour pairs of simplices and check if their transposition will be possible filtration, calculating the scores for the switch-forward transpositions.
\par As we know, an Alpha Complex is a Simplicial Complex, which can be represented as Lefschetz Complex. We also study the dual complexed transposing the border matrices over minor diagonal.

\par We can see the calculated cases in the table the given:
\begin{center}
\begin{tabular}{lllrr}
\toprule
&  & complex & alpha & dual \\
case & n & dim &  &  \\
\midrule
1 & 6 & 2 & 0 & 1 \\
\cline{1-5} \cline{2-5}
2 & 6 & 2 & 2 & 3 \\
\cline{1-5} \cline{2-5}
3 & 6 & 2 & 4 & 5 \\
\cline{1-5} \cline{2-5}
4 & 6 & 2 & 6 & 7 \\
\cline{1-5} \cline{2-5}
5 & 6 & 2 & 8 & 9 \\
\cline{1-5} \cline{2-5}
6 & 6 & 2 & 10 & 11 \\
\cline{1-5} \cline{2-5}
7 & 8 & 2 & 12 & 13 \\
\cline{1-5} \cline{2-5}
8 & 8 & 2 & 14 & 15 \\
\cline{1-5} \cline{2-5}
9 & 8 & 2 & 16 & 17 \\
\cline{1-5} \cline{2-5}
10 & 8 & 2 & 18 & 19 \\
\cline{1-5} \cline{2-5}
11 & 8 & 2 & 20 & 21 \\
\cline{1-5} \cline{2-5}
12 & 8 & 2 & 22 & 23 \\
\cline{1-5} \cline{2-5}
13 & 8 & 2 & 24 & 25 \\
\cline{1-5} \cline{2-5}
14 & 8 & 2 & 26 & 27 \\
\cline{1-5} \cline{2-5}
15 & 8 & 2 & 28 & 29 \\
\cline{1-5} \cline{2-5}
\bottomrule
\end{tabular}
\begin{tabular}{lllrr}
\toprule
&  & complex & alpha & dual \\
case & n & dim &  &  \\
\midrule
16 & 8 & 2 & 30 & 31 \\
\cline{1-5} \cline{2-5}
17 & 12 & 2 & 32 & 33 \\
\cline{1-5} \cline{2-5}
18 & 12 & 2 & 34 & 35 \\
\cline{1-5} \cline{2-5}
19 & 12 & 2 & 36 & 37 \\
\cline{1-5} \cline{2-5}
20 & 12 & 2 & 38 & 39 \\
\cline{1-5} \cline{2-5}
21 & 12 & 2 & 40 & 41 \\
\cline{1-5} \cline{2-5}
22 & 12 & 2 & 42 & 43 \\
\cline{1-5} \cline{2-5}
23 & 16 & 2 & 44 & 45 \\
\cline{1-5} \cline{2-5}
24 & 16 & 2 & 46 & 47 \\
\cline{1-5} \cline{2-5}
25 & 8 & 3 & 48 & 49 \\
\cline{1-5} \cline{2-5}
26 & 8 & 3 & 50 & 51 \\
\cline{1-5} \cline{2-5}
27 & 8 & 3 & 52 & 53 \\
\cline{1-5} \cline{2-5}
28 & 8 & 3 & 54 & 55 \\
\cline{1-5} \cline{2-5}
29 & 8 & 3 & 56 & 57 \\
\cline{1-5} \cline{2-5}
30 & 8 & 3 & 58 & 59 \\
\cline{1-5} \cline{2-5}
\bottomrule
\end{tabular}

\end{center}


\section{Unexpected Cases}
\subsection{Lemma 3.1}

\par Lemma 3.1 can be measured by 2 scores: \textbf{jacard\_l31a} and \textbf{jacard\_l31b}.
And there are 5 of 29 switch-forward birth-birth transpositions found where these scores are not 1.
\par We can see these situations in the table:
\begin{center}\begin{tabular}{rrllrrl}
\toprule
case & complex & simplex 0 & simplex 1 & jacard\_l31a & jacard\_l31b & Figure \\
\midrule
16 & 31 & (5, 6) & (6, 7) & 1.00 & NaN & Figure \ref{fig:unexpected639} \\
18 & 35 & (9, 11) & (5, 11) & 1.00 & NaN & Figure \ref{fig:unexpected814} \\
20 & 38 & (7,) & (8,) & 1.00 & NaN &  \\
24 & 46 & (14,) & (15,) & 1.00 & 0.00 & Figure \ref{fig:unexpected1280} \\
29 & 57 & (3, 7) & (2, 7) & 1.00 & NaN &  \\
\bottomrule
\end{tabular}
\end{center}
\subsection{Lemma 3.2}

\par Lemma 3.2 can be measured by 2 scores: \textbf{jacard\_l32a} and \textbf{jacard\_l32b}.
And there are 5 of 29 switch-forward death-death transpositions found where these scores are not 1.
\par We can see these situations in the table:
\begin{center}\begin{tabular}{rrllrrl}
\toprule
case & complex & simplex 0 & simplex 1 & jacard\_l32a & jacard\_l32b & Figure \\
\midrule
16 & 30 & (6, 7) & (5, 6) & 1.00 & NaN & Figure \ref{fig:unexpected620} \\
18 & 34 & (5, 11) & (9, 11) & 1.00 & NaN & Figure \ref{fig:unexpected755} \\
20 & 39 & (8,) & (7,) & 1.00 & NaN &  \\
24 & 47 & (15,) & (14,) & 1.00 & NaN &  \\
29 & 56 & (2, 7) & (3, 7) & 1.00 & NaN &  \\
\bottomrule
\end{tabular}
\end{center}
\subsection{Lemma 3.3}

\par Lemma 3.3 can be measured by 2 scores: \textbf{jacard\_l33a} and \textbf{jacard\_l33b}.
And there are 0 of 172 switch-forward birth-death transpositions found where these scores are not 1.

\subsection{Hypothesis}

\par The Hypothesis can be measured by 2 scores: \textbf{jacard\_nn\_nodes} and \textbf{jacard\_nn\_edges}.
And there are 12 of 1896 transpositions found where these scores are not 1.
\par We can see these situations in the table:
\begin{center}\begin{tabular}{rrllrrl}
\toprule
case & complex & simplex 0 & simplex 1 & jacard\_nn\_nodes & jacard\_nn\_edges & Figure \\
\midrule
3 & 4 & (0, 1) & (1, 2) & 1.00 & 0.50 & Figure \ref{fig:unexpected69} \\
3 & 5 & (1, 2) & (0, 1) & 1.00 & 0.50 &  \\
5 & 8 & (1, 2) & (2, 4) & 1.00 & 0.00 & Figure \ref{fig:unexpected128} \\
5 & 9 & (2, 4) & (1, 2) & 1.00 & 0.00 &  \\
13 & 24 & (0, 1) & (1, 4) & 1.00 & 0.00 &  \\
13 & 25 & (1, 4) & (0, 1) & 1.00 & 0.00 &  \\
17 & 32 & (0, 2, 7) & (0, 2, 8) & 1.00 & 0.89 & Figure \ref{fig:unexpected681} \\
17 & 33 & (0, 2, 8) & (0, 2, 7) & 1.00 & 0.89 &  \\
19 & 36 & (3, 8) & (1, 9) & 1.00 & 0.00 &  \\
19 & 37 & (1, 9) & (3, 8) & 1.00 & 0.00 &  \\
24 & 46 & (4, 10) & (0, 4) & 1.00 & 0.80 & Figure \ref{fig:unexpected1298} \\
24 & 47 & (0, 4) & (4, 10) & 1.00 & 0.80 &  \\
\bottomrule
\end{tabular}
\end{center}


\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition69.png}
\caption{The birth-death Transposition of simplices (0, 1) and (1, 2) in complex 4}
\label{fig:unexpected69}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition128.png}
\caption{The birth-death Transposition of simplices (1, 2) and (2, 4) in complex 8}
\label{fig:unexpected128}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition620.png}
\caption{The death-death Transposition of simplices (6, 7) and (5, 6) in complex 30}
\label{fig:unexpected620}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition639.png}
\caption{The birth-birth Transposition of simplices (5, 6) and (6, 7) in complex 31}
\label{fig:unexpected639}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition681.png}
\caption{The death-death Transposition of simplices (0, 2, 7) and (0, 2, 8) in complex 32}
\label{fig:unexpected681}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition755.png}
\caption{The death-death Transposition of simplices (5, 11) and (9, 11) in complex 34}
\label{fig:unexpected755}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition814.png}
\caption{The birth-birth Transposition of simplices (9, 11) and (5, 11) in complex 35}
\label{fig:unexpected814}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition1280.png}
\caption{The birth-birth Transposition of simplices (14,) and (15,) in complex 46}
\label{fig:unexpected1280}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition1298.png}
\caption{The birth-birth Transposition of simplices (4, 10) and (0, 4) in complex 46}
\label{fig:unexpected1298}
\end{figure}




\end{document}