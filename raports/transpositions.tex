\documentclass{article}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{makecell}

\begin{document}


\section{Problems}

\par Write $\text{Succ}(s, t) = \text{Succ}'(s, t) = \text{Succ}''(s, t)$ for the succesors and $\text{Pred}(s, t) = \text{Pred}'(s, t) = \text{Pred}''(s, t)$ for the predecessors (ancessors) of the pair in $D$, $D'$, $D''$, respectively.

\par Since $D = D' \cup D''$, we also have $\text{Succ}(s, t) = \text{Succ}'(s, t) \cup \text{Succ}''(s, t)$ and $\text{Pred}(s, t) = \text{Pred}'(s, t) \cup \text{Pred}''(s, t)$.

\subsection{Lemma 3.1.}
\par Suppose $(x, y)$ and $(a, b)$ are birth-death pairs of $f: X\to R$, $a, x$ are consecutive in the ordering of the cellls by $f$, and the transposition $a, x$ is a switch. Then
\begin{itemize}
\item[a] $
W'_\text{after}[y, t] =
\begin{cases}
W'_\text{before}[y, t] + W'_\text{before}[b, t], \;\; \text{if}\; t\ne b \\
W'_\text{before}[y, b] + 1, \;\; \text{otherwise}
\end{cases}
$
\item[b] $W'_\text{after}[b, t] = W'_\text{before}[b, t]$
\end{itemize}

These 2 formulas can be descripted in archaic way:
\begin{itemize}
\item[a] $(y, t)\in B'_\text{after}$ iff one of the sentences is true:
\begin{itemize}
\item $t\ne b$ and $(y, t)\in B'_\text{before}$ and $(b, t)\notin B'_\text{before}$
\item $t\ne b$ and $(y, t)\notin B'_\text{before}$ and $(b, t)\in B'_\text{before}$
\item $t = b$ and $(y, b)\notin B'_\text{before}$
\end{itemize}
\item[b] $(b, t)\in B'_\text{aftr}$ iff $(b, t)\in B'_\text{before}$
\end{itemize}

And they have implications:

\begin{itemize}
\item[c] $
\text{Succ}'_\text{after}(a, y) =
\begin{cases}
\text{Succ}'_\text{before}(x, y) \cup \text{Succ}'_\text{before}(a, b) \cup \{(x, b)\}, \;\; \text{if}\; (a, b)\notin \text{Succ}'_\text{before}(x, y) \\
\text{Succ}'_\text{before}(x, y) / (\{a, b\} \cup \{(s, t)\in \text{Succ}'_\text{before}(a, b):\; \kappa(t, a) = 0\})
\end{cases}
$
\item[d] $\text{Succ}'_\text{after}(x, b) = \text{Succ}'_\text{before}(a, b)$
\end{itemize}


\subsection{Hypothesis 1}
\par Suppose $a$ and $b$ are 2-simplices consecutive in the ordering by $f$. And there is another Morse function $f^*$:
$$
f^*(s) =
\begin{cases}
f(s), \; \text{if} \; s\ne a, b \\
f(b), \; \text{if} \; s = a \\
f(a), \; \text{if} \; s = b
\end{cases}
$$
Let's denote $DP_{f}^\text{min}$ the transitive reduction of the Depth Poset defined by the filtration $f$. And let's deonote $DP_{f}^\text{min}(s)$ the set of nodes in $DP_f(s)$ which are pairs containing cell $s$ and the set of edges with these nodes.

\par \textbf{Hypothesis:} if the cell $s$ has no faces and cofaces with $a$ and $b$, then $DP_f^\text{min}(s) = DP_{f^*}^\text{min}(s)$


\section{Model and Experiments}

\par The probabilistic model is simple. The first we just generate the cloud of $n$ points uniformly distributed in $[0, 1]^d$. After this we calculate the Alpha Complex with these points, and then find its Depth Poset. Then we itarate all neighbour pairs of simplices and check if their transposition will be possible filtration, calculating the scores for the switch-forward transpositions.
\par As we know, an Alpha Complex is a Simplicial Complex, which can be represented as Lefschetz Complex. We also study the dual complexed transposing the border matrices over minor diagonal.

\par We can see the calculated cases in the table the given:
\begin{center}
\begin{tabular}{lllrr}
\toprule
&  & complex & alpha & dual \\
case & n & dim &  &  \\
\midrule
1 & 6 & 2 & 2 & 3 \\
\cline{1-5} \cline{2-5}
2 & 6 & 2 & 4 & 5 \\
\cline{1-5} \cline{2-5}
3 & 6 & 2 & 6 & 7 \\
\cline{1-5} \cline{2-5}
4 & 6 & 2 & 8 & 9 \\
\cline{1-5} \cline{2-5}
5 & 6 & 2 & 10 & 11 \\
\cline{1-5} \cline{2-5}
6 & 6 & 2 & 12 & 13 \\
\cline{1-5} \cline{2-5}
7 & 8 & 2 & 14 & 15 \\
\cline{1-5} \cline{2-5}
8 & 8 & 2 & 16 & 17 \\
\cline{1-5} \cline{2-5}
9 & 8 & 2 & 18 & 19 \\
\cline{1-5} \cline{2-5}
10 & 8 & 2 & 20 & 21 \\
\cline{1-5} \cline{2-5}
\bottomrule
\end{tabular}
\begin{tabular}{lllrr}
\toprule
&  & complex & alpha & dual \\
case & n & dim &  &  \\
\midrule
11 & 8 & 2 & 22 & 23 \\
\cline{1-5} \cline{2-5}
12 & 8 & 2 & 24 & 25 \\
\cline{1-5} \cline{2-5}
13 & 8 & 2 & 26 & 27 \\
\cline{1-5} \cline{2-5}
14 & 8 & 2 & 28 & 29 \\
\cline{1-5} \cline{2-5}
15 & 8 & 3 & 30 & 31 \\
\cline{1-5} \cline{2-5}
16 & 8 & 3 & 32 & 33 \\
\cline{1-5} \cline{2-5}
17 & 8 & 3 & 34 & 35 \\
\cline{1-5} \cline{2-5}
18 & 8 & 3 & 36 & 37 \\
\cline{1-5} \cline{2-5}
19 & 8 & 3 & 38 & 39 \\
\cline{1-5} \cline{2-5}
20 & 8 & 3 & 40 & 41 \\
\cline{1-5} \cline{2-5}
\bottomrule
\end{tabular}

\end{center}

\par We also check few specific transpositions for cases, with given border matrices:
\begin{center}
\begin{tabular}{rrlr}
\toprule
complex & dim & matrix & transpositions \\
\midrule
0 & 2 & $\begin{pmatrix}0 & 0 & 1 \\1 & 1 & 1 \\1 & 0 & 1\end{pmatrix}$ & 1 \\
1 & 1 & $\begin{pmatrix}0 & 0 & 1 \\1 & 1 & 0 \\1 & 0 & 1\end{pmatrix}$ & 1 \\
\bottomrule
\end{tabular}

\end{center}

\par We can see the distribution of transposition types in each complex in the given table:
\begin{center}
\begin{tabular}{lrrrrrrrr}
\toprule
& \multicolumn{3}{r}{switch forward} & \multicolumn{2}{r}{switch backward} & \multicolumn{3}{r}{no switch} \\
& \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\death} & \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\death} \\
complex &  &  &  &  &  &  &  &  \\
\midrule
Total & 26 & 24 & 128 & 15 & 15 & 263 & 223 & 400 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
2 & 1 & 1 & 2 & 0 & 0 & 4 & 3 & 5 \\
3 & 1 & 1 & 2 & 0 & 0 & 4 & 3 & 5 \\
4 & 0 & 0 & 1 & 0 & 0 & 5 & 4 & 5 \\
5 & 0 & 0 & 1 & 0 & 0 & 5 & 4 & 5 \\
6 & 0 & 1 & 1 & 0 & 0 & 6 & 4 & 4 \\
7 & 1 & 0 & 1 & 0 & 0 & 5 & 5 & 4 \\
8 & 0 & 0 & 0 & 0 & 0 & 5 & 4 & 5 \\
9 & 0 & 0 & 0 & 0 & 0 & 5 & 4 & 5 \\
10 & 0 & 0 & 1 & 0 & 2 & 7 & 4 & 3 \\
11 & 0 & 0 & 1 & 2 & 0 & 5 & 6 & 3 \\
12 & 2 & 2 & 1 & 0 & 0 & 3 & 2 & 5 \\
13 & 2 & 2 & 1 & 0 & 0 & 3 & 2 & 5 \\
14 & 0 & 0 & 3 & 3 & 0 & 6 & 8 & 3 \\
15 & 0 & 0 & 3 & 0 & 3 & 9 & 5 & 3 \\
16 & 0 & 0 & 2 & 3 & 1 & 4 & 5 & 8 \\
17 & 0 & 0 & 2 & 1 & 3 & 6 & 3 & 8 \\
18 & 1 & 0 & 1 & 0 & 0 & 6 & 6 & 9 \\
19 & 0 & 1 & 1 & 0 & 0 & 7 & 5 & 9 \\
20 & 1 & 1 & 2 & 0 & 0 & 7 & 6 & 7 \\
21 & 1 & 1 & 2 & 0 & 0 & 7 & 6 & 7 \\
22 & 0 & 0 & 2 & 0 & 0 & 7 & 6 & 9 \\
23 & 0 & 0 & 2 & 0 & 0 & 7 & 6 & 9 \\
24 & 0 & 0 & 2 & 1 & 0 & 6 & 6 & 9 \\
25 & 0 & 0 & 2 & 0 & 1 & 7 & 5 & 9 \\
26 & 1 & 0 & 1 & 0 & 0 & 7 & 7 & 9 \\
27 & 0 & 1 & 1 & 0 & 0 & 8 & 6 & 9 \\
28 & 1 & 1 & 0 & 0 & 0 & 9 & 8 & 5 \\
29 & 1 & 1 & 0 & 0 & 0 & 9 & 8 & 5 \\
30 & 2 & 2 & 9 & 0 & 0 & 8 & 7 & 15 \\
31 & 2 & 2 & 9 & 0 & 0 & 8 & 7 & 15 \\
32 & 0 & 0 & 6 & 1 & 0 & 10 & 10 & 19 \\
33 & 0 & 0 & 6 & 0 & 1 & 11 & 9 & 19 \\
\bottomrule
\end{tabular}

\begin{tabular}{lrrrrrrrr}
\toprule
& \multicolumn{3}{r}{switch forward} & \multicolumn{2}{r}{switch backward} & \multicolumn{3}{r}{no switch} \\
& \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\death} & \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\birth} & \makecell{death-\\death} & \makecell{birth-\\death} \\
complex &  &  &  &  &  &  &  &  \\
\midrule
34 & 1 & 1 & 8 & 1 & 1 & 7 & 6 & 19 \\
35 & 1 & 1 & 8 & 1 & 1 & 7 & 6 & 19 \\
36 & 1 & 2 & 6 & 1 & 1 & 5 & 3 & 25 \\
37 & 2 & 1 & 6 & 1 & 1 & 4 & 4 & 25 \\
38 & 1 & 0 & 8 & 0 & 0 & 9 & 9 & 19 \\
39 & 0 & 1 & 8 & 0 & 0 & 10 & 8 & 19 \\
40 & 0 & 1 & 8 & 0 & 0 & 8 & 6 & 17 \\
41 & 1 & 0 & 8 & 0 & 0 & 7 & 7 & 17 \\
\bottomrule
\end{tabular}

\end{center}



\section{Scores}

\par \textbf{jacard\_nodes\_filtration} -
The Jacard index of node sets from 2 depth posets.
The birth-death pairs are equal in terms of filtration values.


\par \textbf{jacard\_nodes\_simplex} -
The Jacard index of nodes from 2 depth posets.
The birth-death pairs are equal in terms of simplices.


\par \textbf{jacard\_edges\_filtration} -
The Jacard index of edge sets from transitive reductions of 2 depth posets.
The birth-death pairs are equal in terms of filtration values.


\par \textbf{jacard\_edges\_simplex} -
The Jacard index of edge sets from transitive reductions of 2 depth posets.
The birth-death pairs are equal in terms of simplices.


\par \textbf{l31a} -
Returns the portion of simplices t which are births or deaths in both depth posets such that
$
W'_\text{after}[y, t] =
\begin{cases}
W'_\text{before}[y, t] + W'_\text{before}[b, t], \;\; \text{if}\; t\ne b \\
W'_\text{before}[y, b] + 1, \;\; \text{otherwise}
\end{cases}
$


\par \textbf{l31b} -
Returns the portion of simplices t which are births or deaths in both depth posets such that
$W'_\text{after}[b, t] = W'_\text{before}[b, t]$


\par \textbf{l31c} -
If $(a, b) \notin \text{Desc}'(x, y)$ will return the Jacard index of
sets: $\text{Desc}'_\text{after}(a, y)$ and $\text{Desc}'_\text{before}(x, y) \cup \text{Desc}'_\text{before}(a, b) \cup \{(x, b)\}$.
And will return the Jacard index of sets $\text{Desc}'_\text{after}(a, y)$ and
$\text{Desc}'_\text{before}(x, y) / (\{a, b\} \cup \{(s, t)\in \text{Desc}'_\text{before}(a, b):\; \kappa(t, a) = 0\})$
otherwise.


\par \textbf{l31d} -
The Jacard index of sets $\text{Desc}'_\text{after}(x, b)$ and $\text{Desc}'_\text{before}(a, b)$


\par \textbf{jacard\_nn\_nodes} -
The Jacard index of subsets of nodes $(s, t)$ from 2 depth posets, s.t.
$s, t \notin \nabla\partial\sigma_0 \cup \partial\nabla\sigma_0 \cup \nabla\partial\sigma_1 \cup \partial\nabla\sigma_1$,
where $\sigma_0$ and $\sigma_1$ are transposing simplices.


\par \textbf{jacard\_nn\_edges} -
The Jacard index of subsets of edges $((s_0, t_0), (s_1, t_1))$ from 2 depth posets, s.t.
$s_0, t_0, s_1, t_1 \notin \nabla\partial\sigma_0 \cup \partial\nabla\sigma_0 \cup \nabla\partial\sigma_1 \cup \partial\nabla\sigma_1$,
where $\sigma_0$ and $\sigma_1$ are transposing simplices.



\section{Conclusions and Unexpected Cases}

\subsection{Lemma 3.1}
\par Lemma 3.1 can be measured by 2 scores: \textbf{l31a}, \textbf{l31b}, \textbf{l31c}, \textbf{l31d}.
And there are 0 of 26 switch forward birth-birth transpositions found where these scores are not 1.

\subsection{Hypothesis}
\par Hypothesis can be measured by 2 scores: \textbf{jacard\_nn\_nodes}, \textbf{jacard\_nn\_edges}.
And there are 2 of 1094  transpositions found where these scores are not 1.
\par We can see these situations in the table:
\begin{center}\begin{tabular}{lrllrrl}
\toprule
case & complex & simplex 0 & simplex 1 & jacard\_nn\_nodes & jacard\_nn\_edges & Figure \\
\midrule
& 0 & 1 & 2 & NaN & NaN & Figure \ref{fig:unexpected0} \\
& 1 & 1 & 2 & NaN & NaN & Figure \ref{fig:unexpected1} \\
\bottomrule
\end{tabular}
\end{center}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition0.png}
\caption{The birth-birth Transposition of simplices 1 and 2 in complex 0}
\label{fig:unexpected0}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transposition1.png}
\caption{The birth-birth Transposition of simplices 1 and 2 in complex 1}
\label{fig:unexpected1}
\end{figure}




\end{document}