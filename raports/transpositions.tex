\documentclass{article}
\usepackage{amsfonts} 
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{booktabs}


\begin{document}


\section{Problems}
\par Write $\text{Succ}(s, t) = \text{Succ}'(s, t) = \text{Succ}''(s, t)$ for the succesors and $\text{Pred}(s, t) = \text{Pred}'(s, t) = \text{Pred}''(s, t)$ for the predecessors (ancessors) of the pair in $D$, $D'$, $D''$, respectively.

\par Since $D = D' \cup D''$, we also have $\text{Succ}(s, t) = \text{Succ}'(s, t) \cup \text{Succ}''(s, t)$ and $\text{Pred}(s, t) = \text{Pred}'(s, t) \cup \text{Pred}''(s, t)$.

\subsection{Lemma 3.1.}
\par Suppose $(x, y)$ and $(a, b)$ are birth-death pairs of $f: X\to R$, $a, x$ are consecutive in the ordering of the cellls by $f$, and the transposition $a, x$ is a switch. Then
$$
\text{Succ}'(a, y) = \{(x, b)\} \cup \text{Succ}'(a, b) \cup \{(s, t)\in \text{Succ}'(x, y) | f(t)<f(b)\}
$$
$$
\text{Succ}'(x, b) = \{(s, t)\in \text{Succ}'(x, y) | f(t) > f(b)\}
$$

\subsection{Lemma 3.2.}
\par Suppose $(a, b)$ and $(x, y)$ are birth-death pairs of $f:X\to R$, $y, b$ are consecutive in the ordering by $f$, and transposition of $y, b$ is a switch. Then
$$
\text{Succ}''(x, b) = \{(a, y)\} \cup \text{Succ}''(a, b) \cup \{(s, t)\in \text{Succ}''(x, y) | f(a) < f(s) < f(x)\}
$$
$$
\text{Succ}''(a, y) = \{(s, t)\in\text{Succ}''(x, y) | f(s) < f(a)\}
$$

\subsection{Lemma 3.3.}
\par Suppose $(a, b)$ and $(x, y)$ are birth-death pairs of $f$: $X\to R$, $b, x$ are consecutive in the ordering by $f$, and the transposition of $b, x$ is a switch. Then
$$
\text{Succ}(a, x) = \text{Succ}(a, b)
\;\;\text{and}\;\; 
\text{Succ}(b, y) = \text{Succ}(x, y)
$$

\subsection{Hypothesis 1}: 
\par Suppose $a$ and $b$ are 2-simplices consecutive in the ordering by $f$. And there is another Morse function $f^*$: 
$$
f^*(s) = 
\begin{cases}
f(s), \; \text{if} \; s\ne a, b \\
f(b), \; \text{if} \; s = a \\
f(a), \; \text{if} \; s = b
\end{cases}
$$
Let's denote $DP_{f}$ the transitive reduction of the Depth Poset defined by the filtration $f$. And let's deonote $DP_{f}(s)$ the set of nodes in $DP_f(s)$ which are pairs containing cell $s$ and the set of edges with these nodes.

\par \textbf{Hypothesis:} if the cell $s$ has no faces and cofaces with $a$ and $b$, then $DP_f(s) = DP_{f^*}(s)$.


\section{Model}
\par The probabilistic model is simple. The first we just generate the cloud of $n$ points uniformly distributed in $[0, 1]^d$. After this we calculate the Alpha complex with these points, and then find its depth poset. Then we itarate all neighbour pairs of simplices and check if their transposition will be possible filtration, calculating the scores for the switch-forward transpositions.
\par We can see the generated cloud and its simplicial complex in the Figure \ref{fig:cloud}.

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{pics/transpositions-cloud.png}
\label{fig:cloud}
\caption{The generated cloud and coresponding simplicial complex}
\end{figure}

\section{Scores description}

\begin{itemize}

    \item \textbf{jacard\_nodes\_filtration}: The Jacard index of node sets from 2 depth posets.
    The birth-death pairs are equal in terms of filtration values.
    
    \item \textbf{jacard\_nodes\_simplex}: The Jacard index of nodes from 2 depth posets.
    The birth-death pairs are equal in terms of simplices.
    
    \item \textbf{jacard\_edges\_filtration}: The Jacard index of edge sets from transitive reductions of 2 depth posets.
    The birth-death pairs are equal in terms of filtration values.
    
    \item \textbf{jacard\_edges\_simplex}: The Jacard index of edge sets from transitive reductions of 2 depth posets.
    The birth-death pairs are equal in terms of simplices.
    
    \item \textbf{jacard\_l31a}: Jacard Index of $\text{Succ}'(a, y)$ and $(\{(x, b)\} \cup \text{Succ}'(a, b) \cup \{(s, t)\in \text{Succ}'(x, y) | f(t)<f(b)\})$
    
    \item \textbf{jacard\_l31b}: Jacard Index of $\text{Succ}'(x, b)$ and $\{(s, t)\in \text{Succ}'(x, y) | f(t) > f(b)\}$
    
    \item \textbf{jacard\_l32a}: Jacard Index of $\text{Succ}''(x, b)$ and $\{(a, y)\} \cup \text{Succ}''(a, b) \cup \{(s, t)\in \text{Succ}''(x, y) | f(a) < f(s) < f(x)\}$
    
    \item \textbf{jacard\_l32b}: Jacard Index of $\text{Succ}''(a, y)$ and $\{(s, t)\in \text{Succ}''(x, y) | f(s) < f(a)\}$
    
    \item \textbf{jacard\_l33a}: Jacard Index of $\text{Succ}(a, x)$ and $\text{Succ}(a, b)$
    
    \item \textbf{jacard\_l33b}: Jacard Index of $\text{Succ}(b, y)$ and $\text{Succ}(x, y)$
    
    \item \textbf{jacard\_nn\_nodes}: The Jacard index of subsets of nodes $(s, t)$ from 2 depth posets, s.t. 
    $s, t \notin \nabla\partial\sigma_0 \cup \partial\nabla\sigma_0 \cup \nabla\partial\sigma_1 \cup \partial\nabla\sigma_1$,
    where $\sigma_0$ and $\sigma_1$ are transposing simplices.
    
    \item \textbf{jacard\_nn\_edges}: The Jacard index of subsets of edges $((s_0, t_0), (s_1, t_1))$ from 2 depth posets, s.t. 
    $s_0, t_0, s_1, t_1 \notin \nabla\partial\sigma_0 \cup \partial\nabla\sigma_0 \cup \nabla\partial\sigma_1 \cup \partial\nabla\sigma_1$,
    where $\sigma_0$ and $\sigma_1$ are transposing simplices.
    
\end{itemize}


\section{Results}

\par Here are the tables, containing the scores for the switch transpositions in the experiment:

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_nodes\_filtration & jacard\_nodes\_simplex \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & 1.00 & 0.90 \\
29 & 30 & [6, 8] & [6, 15] & birth-death & 1.00 & 0.90 \\
35 & 36 & [8, 10] & [1, 10] & death-death & 1.00 & 0.90 \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & 1.00 & 0.90 \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 1.00 & 0.90 \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 1.00 & 0.90 \\
\bottomrule
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_edges\_filtration & jacard\_edges\_simplex \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & 0.96 & 0.81 \\
29 & 30 & [6, 8] & [6, 15] & birth-death & 0.92 & 0.85 \\
35 & 36 & [8, 10] & [1, 10] & death-death & 0.92 & 0.71 \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & 1.00 & 0.85 \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 1.00 & 0.85 \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 1.00 & 0.60 \\
\bottomrule
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_l31a & jacard\_l31b \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & NaN & NaN \\
29 & 30 & [6, 8] & [6, 15] & birth-death & NaN & NaN \\
35 & 36 & [8, 10] & [1, 10] & death-death & 0.80 & 0.00 \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & 1.00 & 1.00 \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 0.67 & 1.00 \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 0.86 & 1.00 \\
\bottomrule
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_l32a & jacard\_l32b \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & NaN & NaN \\
29 & 30 & [6, 8] & [6, 15] & birth-death & NaN & NaN \\
35 & 36 & [8, 10] & [1, 10] & death-death & 0.00 & 0.00 \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & 0.00 & 0.00 \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 0.00 & 0.00 \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 0.00 & 0.00 \\
\bottomrule
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_l33a & jacard\_l33b \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & 0.50 & 0.50 \\
29 & 30 & [6, 8] & [6, 15] & birth-death & 0.00 & 0.00 \\
35 & 36 & [8, 10] & [1, 10] & death-death & NaN & NaN \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & NaN & NaN \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & NaN & NaN \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & NaN & NaN \\
\bottomrule
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{rrlllrr}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_nn\_nodes & jacard\_nn\_edges \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & 1.00 & 1.00 \\
29 & 30 & [6, 8] & [6, 15] & birth-death & 1.00 & 1.00 \\
35 & 36 & [8, 10] & [1, 10] & death-death & 1.00 & 1.00 \\
46 & 47 & [7, 9] & [7, 14] & birth-birth & 1.00 & 1.00 \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 1.00 & 1.00 \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 1.00 & 1.00 \\
\bottomrule
\end{tabular}
\end{center}


\section{Unexpected results}

    \par The Hypothesis problem can be measured by 2 scores with expected 
    values: \textbf{jacard\_nn\_edges}, \textbf{jacard\_nn\_nodes}
    There are 1 cases, which does not require the expectations: 
\begin{center}
\begin{tabular}{rrlllrrl}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_nn\_edges & jacard\_nn\_nodes & Figure \\
\midrule
30 & 31 & [6, 15] & [0, 6] & birth-birth & 0.95 & 1.00 & Figure \ref{fig:unexpected29} \\
\bottomrule
\end{tabular}
\end{center}.
    
    \par The Lemma 3.1 problem can be measured by 2 scores with expected 
    values: \textbf{jacard\_l31a}, \textbf{jacard\_l31b}
    There are 0 cases, which does not require the expectations. 
    
    \par The Lemma 3.2 problem can be measured by 2 scores with expected 
    values: \textbf{jacard\_l32a}, \textbf{jacard\_l32b}
    There are 3 cases, which does not require the expectations: 
\begin{center}
\begin{tabular}{rrlllrrl}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_l32a & jacard\_l32b & Figure \\
\midrule
35 & 36 & [8, 10] & [1, 10] & death-death & 0.00 & 0.00 & Figure \ref{fig:unexpected33} \\
62 & 63 & [7, 8, 12] & [6, 8, 12] & death-death & 0.00 & 0.00 & Figure \ref{fig:unexpected51} \\
65 & 66 & [2, 4, 11] & [2, 11, 14] & death-death & 0.00 & 0.00 & Figure \ref{fig:unexpected53} \\
\bottomrule
\end{tabular}
\end{center}.
    
    \par The Lemma 3.3 problem can be measured by 2 scores with expected 
    values: \textbf{jacard\_l33a}, \textbf{jacard\_l33b}
    There are 2 cases, which does not require the expectations: 
\begin{center}
\begin{tabular}{rrlllrrl}
\toprule
index 0 & index 1 & simplex 0 & simplex 1 & type & jacard\_l33a & jacard\_l33b & Figure \\
\midrule
23 & 24 & [11, 13] & [5, 11] & birth-death & 0.50 & 0.50 & Figure \ref{fig:unexpected23} \\
29 & 30 & [6, 8] & [6, 15] & birth-death & 0.00 & 0.00 & Figure \ref{fig:unexpected28} \\
\bottomrule
\end{tabular}
\end{center}.
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-23.png}
    \label{fig:unexpected23}
    \caption{The Birth-Death Transposition of simplices [11, 13] and [5, 11]}
    \end{figure}
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-28.png}
    \label{fig:unexpected28}
    \caption{The Birth-Death Transposition of simplices [6, 8] and [6, 15]}
    \end{figure}
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-29.png}
    \label{fig:unexpected29}
    \caption{The Birth-Birth Transposition of simplices [6, 15] and [0, 6]}
    \end{figure}
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-33.png}
    \label{fig:unexpected33}
    \caption{The Death-Death Transposition of simplices [8, 10] and [1, 10]}
    \end{figure}
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-51.png}
    \label{fig:unexpected51}
    \caption{The Death-Death Transposition of simplices [7, 8, 12] and [6, 8, 12]}
    \end{figure}
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{pics/transpositions-unexpected-53.png}
    \label{fig:unexpected53}
    \caption{The Death-Death Transposition of simplices [2, 4, 11] and [2, 11, 14]}
    \end{figure}
    


\end{document}